# 官方手册 - https://manual.nssurge.com/
# 理解原理 - https://manual.nssurge.com/book/understanding-surge/cn/
# 帮助中心 - https://nssurge.zendesk.com/
# 技术社区 - https://community.nssurge.com


# Self-use sgmodule:

# Advanced Settings & URL Redirect - https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Module/General.sgmodule

# Block Advertising for Surge iOS - https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Module/Block/Advertising.sgmodule

# Block YouTube Advertising - https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Module/Block/YouTubeAds.sgmodule

# AllInOne - https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rewrite/Surge/AllInOne/AllInOne.sgmodule

# 复写去广告 - https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rewrite/Surge/Advertising/Advertising.sgmodule

# iRingo for Siri & Search - https://raw.githubusercontent.com/VirgilClyne/iRingo/main/sgmodule/Siri_for_Proxy.sgmodule

# iRingo for Apple Weather - https://raw.githubusercontent.com/VirgilClyne/iRingo/main/sgmodule/Weather.sgmodule

# BoxJs - https://raw.githubusercontent.com/chavyleung/scripts/master/box/rewrite/boxjs.rewrite.surge.sgmodule

# iRingo.boxjs.json - https://raw.githubusercontent.com/VirgilClyne/iRingo/main/box/iRingo.boxjs.json

# 空气质量代码 - EPA_NowCast.2204


[General]
# ✰zkyary Surge 自用配置
# ✰以"#" ";" 和 "//" 开头的行为注释行
# Update-2022.5.06.20.10

# 你可以从该 URL 下载这个配置文件: https://raw.githubusercontent.com/TributePaulWalker/Profiles/main/Surge/Surge%20Pro.conf

# > 增强版 Wi-Fi 助理
# 在 Wi-Fi 网络不佳时尝试使用数据网络建立连接，请仅当使用不限量的数据流量时开启，默认关闭：false,开启把false修改为true即可。
wifi-assist = false

# > Hybrid Network（建议关闭、无限流量或者超出套餐流量不限速可选择开启）
# 对所有策略设置 hybrid = true，所有 TCP 连接在建立时均会并发尝试数据网络和 WiFi 连接。除此之外，所有 DNS 查询操作也都将并发在数据网络和 WiFi 上进行。所以若想体验该功能，请手动配置公网 DNS，暂不支持 DOH。请注意数据网络的套餐流量使用。
# 混合网络，默认关闭：false,开启把false修改为true即可。
all-hybrid = false

# > Internet 测试 URL
internet-test-url = http://wifi.vivo.com.cn/generate_204

# > 代理测速 URL
proxy-test-url = http://cp.cloudflare.com/generate_204

# > 测试超时（秒）
test-timeout = 3

# > 自定义 GeoIP 数据库（根据需求二选一即可）
geoip-maxmind-url = https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb
# geoip-maxmind-url = https://raw.githubusercontent.com/Hackl0us/GeoIP2-CN/release/Country.mmdb

# > GeoIP 数据库自动更新
disable-geoip-db-auto-update = false

# > UDP IP 防泄漏
# 如果没有代理服务器支持 UDP 转发，可修改为「 direct 」或注释下条，但需注意同一目标主机名 TCP 请求与 UDP 请求的源地址不同所造成的隐私及安全风险。
udp-policy-not-supported-behaviour = reject

# > 隐藏状态栏上的VPN图标
hide-vpn-icon = true

# > IPv6 支持（默认关闭）
ipv6 = false

# > 允许 Wi-Fi 访问 (仅 iOS ）
allow-wifi-access = true
wifi-access-http-port = 6152
wifi-access-socks5-port = 6153

# > Allow Hotspot Access（热点分享代理）
allow-hotspot-access = true

# > 允许 Wi-Fi 访问 (仅 macOS，若允许远程访问将「127.0.0.1」改为「0.0.0.0」)
http-listen = 127.0.0.1:6152
socks5-listen = 127.0.0.1:6153

# > HTTP-API
# 依次为：密码，主机名，端口
http-api = zkyary@0.0.0.0:6171

# > HTTP-API-TLS
http-api-tls = false

# > Web控制器
# Safari输入127.0.0.1:6171,填入HTTP-API密码即可。
http-api-web-dashboard = true

# > 兼容模式 (仅 iOS)
# compatibility-mode = 0

# > 跳过代理
skip-proxy = 127.0.0.1, 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 100.64.0.0/10, localhost, *.local, iosapps.itunes.apple.com

# > 排除简单主机名
exclude-simple-hostnames = true

# > DNS 服务器
dns-server = 119.29.29.29, 223.5.5.5, 114.114.114.114, system

# > DNS over HTPPS (如无必要不建议使用 DNS over HTTPS)
# doh-server = https://dns.alidns.com/dns-query
# doh-server = https://doh.pub/dns-query
# doh-server = https://120.53.53.53/dns-query
# doh-server = https://1.12.12.12/dns-query
# doh-server = https://223.5.5.5/dns-query

# > 从 /etc/hosts 读取 DNS 记录
read-etc-hosts = true

# > 日志级别
loglevel = warning

# > 当遇到 REJECT 策略时返回错误页
show-error-page-for-reject = true

# > Always Real IP Hosts
always-real-ip = *.msftconnecttest.com, *.msftncsi.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.logon.battlenet.com.cn, *.logon.battle.net, stun.l.google.com

# Hijack DNS
# hijack-dns = 8.8.8.8:53, 8.8.4.4:53

# > 路由防火墙
# 包含所有的网络请求
include-all-networks = false

# 包含本地网络请求
include-local-networks = false

# 代理请求本地DNS映射
use-local-host-item-for-proxy = false

[Replica]
# 0 为关闭，1 为开启

# > 隐藏 Apple 请求
hide-apple-request = 0

# > 隐藏崩溃追踪器请求
hide-crash-reporter-request = 1

# > 隐藏 UDP 会话
hide-udp = 0

# > 关键词过滤器
# keyword-filter-type = none

# > 关键词
# keyword-filter = (null)

[SSID Setting]
# > Wi-Fi 蜂窝 强制启用TCP Fast Open
// TYPE:WIFI tfo-behaviour=force-enabled
// TYPE:CELLULAR tfo-behaviour=force-enabled

[Proxy]
# > 别名策略+代理
𝗗𝗜𝗥𝗘𝗖𝗧 = direct
𝗛𝗬𝗕𝗥𝗜𝗗 = direct, hybrid=on

[Proxy Group]
# > 自定义策略
# 机场信息 A
𝗡𝗲𝘅𝗶𝘁𝗮𝗹𝗹𝘆 = select, policy-path=http://sub.info?url=(这个网站转义https://www.urlencoder.org)&reset_day=11&alert=1&title=Nexitally, update-interval=3600, no-alert=0, hidden=0, include-all-proxies=0
# 机场信息 B
𝗗𝗹𝗲𝗿𝗖𝗹𝗼𝘂𝗱 = select, policy-path=http://sub.info?url=(这个网站转义https://www.urlencoder.org)&reset_day=1&alert=1&title=DlerCloud, update-interval=3600, no-alert=0, hidden=0, include-all-proxies=0
# 备用线路
𝗦𝘁𝗮𝗻𝗱𝗯𝘆 = select, policy-path=https://sub.store/download/collection/Server, update-interval=43200, no-alert=0, hidden=0, include-all-proxies=0
# 代理选择
𝗣𝗥𝗢𝗫𝗬 = select, 𝗔𝗨𝗧𝗢 🄰, 𝗔𝗨𝗧𝗢 🄱, 𝗦𝘁𝗮𝗻𝗱𝗯𝘆, 𝗛𝗼𝗻𝗴 𝗞𝗼𝗻𝗴, 𝗧𝗮𝗶𝘄𝗮𝗻, 𝗦𝗶𝗻𝗴𝗮𝗽𝗼𝗿𝗲, 𝗝𝗮𝗽𝗮𝗻, 𝗨𝗻𝗶𝘁𝗲𝗱 𝗦𝘁𝗮𝘁𝗲𝘀, 𝗞𝗼𝗿𝗲𝗮, 𝗚𝗲𝗿𝗺𝗮𝗻𝘆, 𝗢𝘁𝗵𝗲𝗿, no-alert=0, hidden=1, include-all-proxies=0
# 延迟选择 A
𝗔𝗨𝗧𝗢 🄰 = url-test, include-other-group="𝗛𝗼𝗻𝗴 𝗞𝗼𝗻𝗴, 𝗦𝗶𝗻𝗴𝗮𝗽𝗼𝗿𝗲", policy-regex-filter=IEPL, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 延迟选择 B
𝗔𝗨𝗧𝗢 🄱 = url-test, include-other-group=𝗛𝗼𝗻𝗴 𝗞𝗼𝗻𝗴, policy-regex-filter=^((?!IEPL|BGP|HKT|NTT|Premium|Stream).)*香港((?!IEPL|BGP|HKT|NTT|Premium|Stream).)*$, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 香港
𝗛𝗼𝗻𝗴 𝗞𝗼𝗻𝗴 = fallback, policy-path=https://sub.store/download/collection/Dler-Nexitally-Surge, policy-regex-filter=香港, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 台湾
𝗧𝗮𝗶𝘄𝗮𝗻 = fallback, policy-path=https://sub.store/download/collection/Dler-Nexitally-Surge, policy-regex-filter=台湾, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 新加坡
𝗦𝗶𝗻𝗴𝗮𝗽𝗼𝗿𝗲 = fallback, policy-path=https://sub.store/download/collection/Dler-Nexitally-Surge, policy-regex-filter=新加坡, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 日本
𝗝𝗮𝗽𝗮𝗻 = fallback, policy-path=https://sub.store/download/collection/Dler-Nexitally-Surge, policy-regex-filter=日本, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 德国
𝗚𝗲𝗿𝗺𝗮𝗻𝘆 = fallback, policy-path=https://sub.store/download/collection/Dler-Nexitally-Surge, policy-regex-filter=德国, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 美国
𝗨𝗻𝗶𝘁𝗲𝗱 𝗦𝘁𝗮𝘁𝗲𝘀 = fallback, policy-path=https://sub.store/download/collection/Dler-Nexitally-Surge, policy-regex-filter=美国, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 韩国
𝗞𝗼𝗿𝗲𝗮 = fallback, policy-path=https://sub.store/download/collection/Dler-Nexitally-Surge, policy-regex-filter=韩国, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# 其它地区
𝗢𝘁𝗵𝗲𝗿 = select, policy-path=https://sub.store/download/collection/Dler-Nexitally-Surge, policy-regex-filter=^((?!香港|台湾|新加坡|日本|韩国|美国|德国).)*$, update-interval=43200, no-alert=0, hidden=1, include-all-proxies=0
# Speedtest
𝗦𝗽𝗲𝗲𝗱𝘁𝗲𝘀𝘁 = select, include-other-group="𝗛𝗼𝗻𝗴 𝗞𝗼𝗻𝗴, 𝗧𝗮𝗶𝘄𝗮𝗻, 𝗦𝗶𝗻𝗴𝗮𝗽𝗼𝗿𝗲, 𝗝𝗮𝗽𝗮𝗻, 𝗨𝗻𝗶𝘁𝗲𝗱 𝗦𝘁𝗮𝘁𝗲𝘀, 𝗞𝗼𝗿𝗲𝗮, 𝗚𝗲𝗿𝗺𝗮𝗻𝘆, 𝗢𝘁𝗵𝗲𝗿, 𝗦𝘁𝗮𝗻𝗱𝗯𝘆", update-interval=43200, no-alert=0, hidden=0, include-all-proxies=0
# Netflix
𝗡𝗲𝘁𝗳𝗹𝗶𝘅 = select, include-other-group=𝗦𝗶𝗻𝗴𝗮𝗽𝗼𝗿𝗲, policy-regex-filter=^((?!BGP).)*$, update-interval=43200, no-alert=0, hidden=0, include-all-proxies=0
# 哔哩哔哩
𝗕𝗶𝗹𝗶𝗕𝗶𝗹𝗶 = select, 𝗗𝗜𝗥𝗘𝗖𝗧, 𝗛𝗼𝗻𝗴 𝗞𝗼𝗻𝗴, 𝗧𝗮𝗶𝘄𝗮𝗻, no-alert=0, hidden=1, include-all-proxies=0
# 苹果服务
𝗔𝗽𝗽𝗹𝗲 = select, 𝗛𝗬𝗕𝗥𝗜𝗗, 𝗗𝗜𝗥𝗘𝗖𝗧, 𝗣𝗥𝗢𝗫𝗬, 𝗔𝗨𝗧𝗢 🄰, 𝗔𝗨𝗧𝗢 🄱, 𝗦𝘁𝗮𝗻𝗱𝗯𝘆, 𝗛𝗼𝗻𝗴 𝗞𝗼𝗻𝗴, 𝗧𝗮𝗶𝘄𝗮𝗻, 𝗦𝗶𝗻𝗴𝗮𝗽𝗼𝗿𝗲, 𝗝𝗮𝗽𝗮𝗻, 𝗨𝗻𝗶𝘁𝗲𝗱 𝗦𝘁𝗮𝘁𝗲𝘀, 𝗞𝗼𝗿𝗲𝗮, 𝗚𝗲𝗿𝗺𝗮𝗻𝘆, 𝗢𝘁𝗵𝗲𝗿, no-alert=0, hidden=1, include-all-proxies=0
# Spotify
𝗦𝗽𝗼𝘁𝗶𝗳𝘆 = select, 𝗛𝗬𝗕𝗥𝗜𝗗, 𝗗𝗜𝗥𝗘𝗖𝗧, 𝗣𝗥𝗢𝗫𝗬, 𝗔𝗨𝗧𝗢 🄰, 𝗔𝗨𝗧𝗢 🄱, 𝗦𝘁𝗮𝗻𝗱𝗯𝘆, 𝗛𝗼𝗻𝗴 𝗞𝗼𝗻𝗴, 𝗧𝗮𝗶𝘄𝗮𝗻, 𝗦𝗶𝗻𝗴𝗮𝗽𝗼𝗿𝗲, 𝗝𝗮𝗽𝗮𝗻, 𝗨𝗻𝗶𝘁𝗲𝗱 𝗦𝘁𝗮𝘁𝗲𝘀, 𝗞𝗼𝗿𝗲𝗮, 𝗚𝗲𝗿𝗺𝗮𝗻𝘆, 𝗢𝘁𝗵𝗲𝗿, no-alert=0, hidden=1, include-all-proxies=0
# Emby
𝗘𝗺𝗯𝘆 = select, 𝗛𝗬𝗕𝗥𝗜𝗗, 𝗗𝗜𝗥𝗘𝗖𝗧, 𝗣𝗥𝗢𝗫𝗬, 𝗔𝗨𝗧𝗢 🄰, 𝗔𝗨𝗧𝗢 🄱, 𝗦𝘁𝗮𝗻𝗱𝗯𝘆, 𝗛𝗼𝗻𝗴 𝗞𝗼𝗻𝗴, 𝗧𝗮𝗶𝘄𝗮𝗻, 𝗦𝗶𝗻𝗴𝗮𝗽𝗼𝗿𝗲, 𝗝𝗮𝗽𝗮𝗻, 𝗨𝗻𝗶𝘁𝗲𝗱 𝗦𝘁𝗮𝘁𝗲𝘀, 𝗞𝗼𝗿𝗲𝗮, 𝗚𝗲𝗿𝗺𝗮𝗻𝘆, 𝗢𝘁𝗵𝗲𝗿, no-alert=0, hidden=0, include-all-proxies=0
# 兜底策略
𝗙𝗶𝗻𝗮𝗹 ✰ = select, 𝗛𝗬𝗕𝗥𝗜𝗗, 𝗗𝗜𝗥𝗘𝗖𝗧, 𝗣𝗥𝗢𝗫𝗬, 𝗔𝗨𝗧𝗢 🄰, 𝗔𝗨𝗧𝗢 🄱, 𝗦𝘁𝗮𝗻𝗱𝗯𝘆, 𝗛𝗼𝗻𝗴 𝗞𝗼𝗻𝗴, 𝗧𝗮𝗶𝘄𝗮𝗻, 𝗦𝗶𝗻𝗴𝗮𝗽𝗼𝗿𝗲, 𝗝𝗮𝗽𝗮𝗻, 𝗨𝗻𝗶𝘁𝗲𝗱 𝗦𝘁𝗮𝘁𝗲𝘀, 𝗞𝗼𝗿𝗲𝗮, 𝗚𝗲𝗿𝗺𝗮𝗻𝘆, 𝗢𝘁𝗵𝗲𝗿, no-alert=0, hidden=0, include-all-proxies=0

[Rule]
# > 规则分流
# 规则修正
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Unbreak.list,𝗗𝗜𝗥𝗘𝗖𝗧
# 广告拦截
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Advertising.list,REJECT-TINYGIF
# 域名拦截
DOMAIN-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/AdvertisingPlus.list,REJECT
# 隐私保护
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Privacy.list,REJECT-TINYGIF
# 运营商劫持
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Hijacking.list,REJECT-TINYGIF
# WeChat
RULE-SET,https://raw.githubusercontent.com/NobyDa/Script/master/Surge/WeChat.list,𝗛𝗬𝗕𝗥𝗜𝗗
# Netflix
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Video/Netflix.list,𝗡𝗲𝘁𝗳𝗹𝗶𝘅
# Spotify
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Spotify/Spotify.list,𝗦𝗽𝗼𝘁𝗶𝗳𝘆
# Emby
RULE-SET,https://raw.githubusercontent.com/githubdulong/Script/master/Surge/Emby.list,𝗘𝗺𝗯𝘆
# Speedtest
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/release/rule/Surge/Speedtest/Speedtest.list,𝗦𝗽𝗲𝗲𝗱𝘁𝗲𝘀𝘁
# TikTok
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Video/TikTok.list,𝗣𝗥𝗢𝗫𝗬
# 哔哩哔哩
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/BiliBili/BiliBili.list,𝗕𝗶𝗹𝗶𝗕𝗶𝗹𝗶
# YouTube
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Video/YouTube.list,𝗦𝘁𝗮𝗻𝗱𝗯𝘆
# 国际流媒体
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Streaming.list,𝗣𝗥𝗢𝗫𝗬
# 全球加速
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Global.list,𝗣𝗥𝗢𝗫𝗬
# TestFlight
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Apple/TestFlight.list,𝗔𝗨𝗧𝗢 🄱
# 苹果服务
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Apple/Apple.list,𝗔𝗽𝗽𝗹𝗲
# 中国直连
RULE-SET,https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/China.list,𝗗𝗜𝗥𝗘𝗖𝗧
# Local Area Network 局域网
RULE-SET,LAN,𝗗𝗜𝗥𝗘𝗖𝗧
# GeoIP China
GEOIP,CN,𝗗𝗜𝗥𝗘𝗖𝗧
# 兜底规则
FINAL,𝗙𝗶𝗻𝗮𝗹 ✰,dns-failed

[Host]
# > DNS 映射
# IPv6
ip6-localhost = ::1
ip6-loopback = ::1
# DNS 服务器
taobao.com = server:223.6.6.6
*.taobao.com = server:223.6.6.6
tmall.com = server:223.6.6.6
*.tmall.com = server:223.6.6.6
jd.com = server:119.29.29.29
*.jd.com = server:119.28.28.28
*.qq.com = server:119.28.28.28
*.bilibili.com = server:119.29.29.29
*.tencent.com = server:119.28.28.28
*.alicdn.com = server:223.5.5.5
aliyun.com = server:223.5.5.5
*.aliyun.com = server:223.5.5.5
weixin.com = server:119.28.28.28
*.weixin.com = server:119.28.28.28
hdslb.com = server:119.29.29.29
163.com = server:119.29.29.29
*.163.com = server:119.29.29.29
126.com = server:119.29.29.29
*.126.com = server:119.29.29.29
*.126.net = server:119.29.29.29
*.127.net = server:119.29.29.29
*.netease.com = server:119.29.29.29
mi.com = server:119.29.29.29
*.mi.com = server:119.29.29.29
xiaomi.com = server:119.29.29.29
*.xiaomi.com = server:119.29.29.29
dler.cloud = server:180.76.76.76
dleris.best = server:180.76.76.76
routerlogin.net = server:syslib
_hotspot_.m2m = server:syslib
router.asus.com = server:syslib
hotspot.cslwifi.com = server:syslib
amplifi.lan = server:syslib
*.lan = server:syslib

[MITM]
skip-server-cert-verify = true
# > VIF 对原始 TCP 流量进行解密
tcp-connection = true
# > CA 证书
ca-passphrase = BB0FABB5
